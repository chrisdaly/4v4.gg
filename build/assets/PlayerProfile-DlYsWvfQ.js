import{u as Es,j as s,l as js,L as J,r as A,t as Us,k as ls,d as Is,q as _s,G as Ws,m as Gs,P as Os,C as Fs,S as Ks,B as $s,n as zs}from"./index-C4yNIdvx.js";import{i as Hs}from"./twitchService-D5TnHh44.js";import{F as Bs}from"./index-l2mFcCMN.js";import{G as Vs}from"./index-Dum7voYv.js";import{F as Cs}from"./FormDots-Bi0AvgSV.js";/* empty css                 *//* empty css                */import{g as Ys,a as Xs,b as qs}from"./formatters-C0HfR3L6.js";import{O as Js}from"./OngoingGame-L9ZUMahO.js";import{p as Qs}from"./digestUtils-BeIn1fKD.js";import"./iconBase-6Dj9gBMc.js";import"./Game-kYTZPDYx.js";import"./MmrComparison-DlP-8o5-.js";const Zs=({game:y,playerBattleTag:c,showAllies:b=!0,linkTo:G,striped:_=!1,className:f=""})=>{var h,P;const k=Es();if(!y)return null;const E=y.match||y,z=c==null?void 0:c.toLowerCase();let L=null,Q=[],H=[];for(const r of E.teams||[]){const u=(h=r.players)==null?void 0:h.find(N=>{var T;return((T=N.battleTag)==null?void 0:T.toLowerCase())===z});u?(L=u,Q=r.players.filter(N=>{var T;return((T=N.battleTag)==null?void 0:T.toLowerCase())!==z})):H=r.players||[]}if(!L)return null;const Y=L.won===!0||L.won===1,B=(L.currentMmr||0)-(L.oldMmr||0),C=((P=E.mapName)==null?void 0:P.replace(/^\(\d\)\s*/,""))||"Unknown",O=Ys(E.mapName),Z=Xs(E.durationInSeconds),F=qs(E.endTime),ss=(E.teams||[]).flatMap(r=>r.players||[]),X=ss.length>0?Math.round(ss.reduce((r,u)=>r+(u.oldMmr||0),0)/ss.length):null,es=E.id||y.id,o=G||(es?`/match/${es}`:null),d=["game-row",Y?"gr-won":"gr-lost",_&&"gr-striped",f].filter(Boolean).join(" "),j=s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"gr-col gr-result",children:s.jsx("span",{className:`gr-badge ${Y?"gr-badge-won":"gr-badge-lost"}`,children:Y?"W":"L"})}),s.jsxs("div",{className:"gr-col gr-map",children:[O&&s.jsx("img",{src:O,alt:C,className:"gr-map-img"}),s.jsx("span",{className:"gr-map-name",children:C})]}),s.jsx("div",{className:"gr-col gr-avg-mmr",children:X&&s.jsx("span",{className:"gr-avg-mmr-value",children:X})}),s.jsx("div",{className:"gr-col gr-mmr",children:s.jsxs("span",{className:`gr-mmr-change ${B>=0?"positive":"negative"}`,children:[B>=0?"+":"",B]})}),b&&s.jsx("div",{className:"gr-col gr-allies",children:s.jsx("div",{className:"gr-players-list",children:Q.slice(0,3).map((r,u)=>s.jsxs("span",{className:"gr-player",onClick:N=>{N.preventDefault(),N.stopPropagation(),k.push(`/player/${encodeURIComponent(r.battleTag)}`)},children:[s.jsx("img",{src:js[r.race],alt:"",className:"gr-race"}),s.jsx("span",{className:"gr-player-name",children:r.name})]},u))})}),b&&s.jsx("div",{className:"gr-col gr-opponents",children:s.jsx("div",{className:"gr-players-list",children:H.slice(0,4).map((r,u)=>s.jsxs("span",{className:"gr-player",onClick:N=>{N.preventDefault(),N.stopPropagation(),k.push(`/player/${encodeURIComponent(r.battleTag)}`)},children:[s.jsx("img",{src:js[r.race],alt:"",className:"gr-race"}),s.jsx("span",{className:"gr-player-name",children:r.name})]},u))})}),s.jsx("div",{className:"gr-col gr-duration",children:Z}),s.jsx("div",{className:"gr-col gr-time",children:F})]});return o?s.jsx(J,{to:o,className:d,children:j}):s.jsx("div",{className:d,children:j})},se="activity-graph-",ee=1800*1e3,ae=13,te=({battleTag:y,currentSeason:c,gateway:b=20})=>{const[G,_]=A.useState({}),[f,k]=A.useState({}),[E,z]=A.useState(!0),[L,Q]=A.useState(null),{weeks:H,monthLabels:Y}=A.useMemo(()=>{const o=[],d=[],j=new Date;j.setHours(0,0,0,0);const h=new Date(j);h.setDate(h.getDate()-ae*7);const P=h.getDay(),r=P===0?-6:1-P;h.setDate(h.getDate()+r);let u=new Date(h),N=-1;for(;u<=j;){const T=[];u.getMonth()!==N&&(d.push({label:u.toLocaleDateString("en-US",{month:"short"}),weekIndex:o.length}),N=u.getMonth());for(let K=0;K<7;K++)T.push(new Date(u)),u.setDate(u.getDate()+1);o.push(T)}return{weeks:o,monthLabels:d}},[]),B=()=>`${se}${y}`,C=()=>{try{const o=localStorage.getItem(B());if(o){const{data:d,seasonRanges:j,timestamp:h}=JSON.parse(o);if(Date.now()-h<ee)return{data:d,ranges:j,isValid:!0}}}catch{}return{data:null,ranges:null,isValid:!1}},O=(o,d)=>{try{localStorage.setItem(B(),JSON.stringify({data:o,seasonRanges:d,timestamp:Date.now()}))}catch{}};A.useEffect(()=>{y&&(async()=>{z(!0);const{data:d,ranges:j,isValid:h}=C();if(h&&d){_(d),k(j||{}),z(!1);return}const P={},r={},u=new Date;u.setMonth(u.getMonth()-3);try{const K=(await(await fetch("https://website-backend.w3champions.com/api/ladder/seasons")).json()).filter(W=>W.id>=c-1&&W.id<=c);for(const W of K){W.startDate&&(r[W.id]={start:new Date(W.startDate),end:W.endDate?new Date(W.endDate):new Date});let as=0;const is=100;let cs=!0;for(;cs;){const hs=`https://website-backend.w3champions.com/api/matches/search?playerId=${encodeURIComponent(y)}&offset=${as}&gameMode=4&season=${W.id}&gateway=${b}&pageSize=${is}`,rs=await fetch(hs);if(!rs.ok)break;const os=(await rs.json()).matches||[];if(os.length===0)break;for(const gs of os){const ds=new Date(gs.endTime);if(ds<u){cs=!1;break}const ts=ds.toISOString().split("T")[0];P[ts]=(P[ts]||0)+1}if(as+=is,as>500)break}}_(P),k(r),O(P,r)}catch(N){console.error("Error fetching activity:",N)}finally{z(!1)}})()},[y,c,b]);const Z=o=>o?o===1?1:o<=3?2:o<=6?3:4:0,F=o=>{const d=f[c];return d?o>=d.start&&o<=d.end:!1},ss=o=>o.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),X=o=>Y.some(d=>d.weekIndex===o),es=A.useMemo(()=>Object.values(G).reduce((o,d)=>o+d,0),[G]);return E?s.jsxs("div",{className:"activity-graph-card",children:[s.jsx("div",{className:"ag-header",children:s.jsx("h3",{className:"ag-title",children:"Activity"})}),s.jsxs("div",{className:"ag-loading",children:[s.jsx("div",{className:"loader-spinner"}),s.jsx("span",{className:"loader-text",children:"Loading"})]})]}):s.jsxs("div",{className:"activity-graph-card",children:[s.jsxs("div",{className:"ag-header",children:[s.jsx("h3",{className:"ag-title",children:"Activity"}),s.jsxs("span",{className:"ag-total",children:[es," games"]})]}),s.jsxs("div",{className:"ag-month-row",children:[s.jsx("div",{className:"ag-day-label-spacer"}),H.map((o,d)=>{const j=Y.find(h=>h.weekIndex===d);return s.jsx("div",{className:`ag-month-cell ${X(d)&&d>0?"ag-month-start":""}`,children:j?j.label:""},d)})]}),s.jsxs("div",{className:"ag-body",children:[s.jsxs("div",{className:"ag-day-labels",children:[s.jsx("span",{children:"M"}),s.jsx("span",{children:"T"}),s.jsx("span",{children:"W"}),s.jsx("span",{children:"T"}),s.jsx("span",{children:"F"}),s.jsx("span",{children:"S"}),s.jsx("span",{children:"S"})]}),s.jsx("div",{className:"ag-grid",children:H.map((o,d)=>s.jsx("div",{className:`ag-week ${X(d)&&d>0?"ag-month-start":""}`,children:o.map((j,h)=>{const P=j.toISOString().split("T")[0],r=G[P]||0,u=Z(r),N=F(j),T=j>new Date;return s.jsx("div",{className:`ag-cell ag-l${u}${N?" ag-season":""}${T?" ag-future":""}`,onMouseEnter:K=>!T&&Q({x:K.clientX,y:K.clientY,text:`${r} game${r!==1?"s":""} on ${ss(j)}`}),onMouseLeave:()=>Q(null)},h)})},d))})]}),L&&s.jsx("div",{className:"ag-tooltip",style:{left:L.x+10,top:L.y-40},children:L.text})]})},ws="https://4v4gg-chat-relay.fly.dev",fs=20,xs=3,Ds=(y,c)=>{const b=`playerPage:${y.toLowerCase()}:${c}`;return Is.get(b)};function ne({clip:y,onClose:c}){const b=A.useRef(null),G=y.embed_url?`${y.embed_url}&parent=4v4.gg&parent=localhost&autoplay=true`:`https://clips.twitch.tv/embed?clip=${y.clip_id}&parent=4v4.gg&parent=localhost&autoplay=true`;return A.useEffect(()=>{var f;(f=b.current)==null||f.focus();const _=k=>{k.key==="Escape"&&c()};return window.addEventListener("keydown",_,!0),()=>window.removeEventListener("keydown",_,!0)},[c]),s.jsx("div",{className:"clip-modal-backdrop",ref:b,tabIndex:-1,onClick:c,children:s.jsxs("div",{className:"clip-modal",onClick:_=>_.stopPropagation(),children:[s.jsx("button",{className:"clip-modal-close",onClick:c,children:"×"}),s.jsx("iframe",{className:"clip-modal-embed",src:G,allowFullScreen:!0,title:y.title}),s.jsxs("div",{className:"clip-modal-info",children:[s.jsx("h2",{className:"clip-modal-title",children:y.title}),s.jsxs("div",{className:"clip-modal-meta",children:[s.jsx("span",{className:"clip-modal-streamer",children:y.twitch_login}),s.jsx("span",{className:"clip-modal-sep",children:"·"}),s.jsxs("span",{className:"clip-modal-views",children:[y.view_count.toLocaleString()," views"]})]})]})]})})}const xe=()=>{var ys,vs,Ss,bs;const c=(()=>{const e=new URL(window.location.href);return decodeURIComponent(e.pathname.split("/").slice(-1)[0])})(),b=c.toLowerCase(),G=c.split("#")[0],[_,f]=A.useReducer((e,a)=>({...e,...a}),{playerData:null,profilePic:null,country:null,twitchName:null,isStreaming:!1,streamInfo:null,matches:[],totalMatches:0,sessionGames:[],seasonMmrs:[],ongoingGame:null,ladderStanding:null,isLoading:!0,allyStats:[],worstAllyStats:[],mapStats:[],worstMapStats:[],nemesisStats:[],selectedSeason:null,availableSeasons:[],currentPage:0,playerClips:[],playerMentions:[]}),{playerData:k,profilePic:E,country:z,twitchName:L,isStreaming:Q,streamInfo:H,matches:Y,totalMatches:B,sessionGames:C,seasonMmrs:O,ongoingGame:Z,ladderStanding:F,isLoading:ss,allyStats:X,worstAllyStats:es,mapStats:o,worstMapStats:d,nemesisStats:j,selectedSeason:h,availableSeasons:P,currentPage:r,playerClips:u,playerMentions:N}=_,[T,K]=A.useState(null),W=60,as=e=>{f({playerData:e.playerData,profilePic:e.profilePic,country:e.country,twitchName:e.twitchName,matches:e.matches||[],totalMatches:e.totalMatches||0,seasonMmrs:e.seasonMmrs||[],ladderStanding:e.ladderStanding,allyStats:e.allyStats||[],worstAllyStats:e.worstAllyStats||[],mapStats:e.mapStats||[],worstMapStats:e.worstMapStats||[],nemesisStats:e.nemesisStats||[],isLoading:!1})};A.useEffect(()=>{(async()=>{try{const a=await zs();if(a&&a.length>0){const n=a[0].id;f({availableSeasons:a,selectedSeason:n});const l=Ds(c,n);l&&as(l)}}catch(a){console.error("Failed to fetch seasons:",a),f({selectedSeason:24})}})()},[c]),A.useEffect(()=>{if(h===null)return;const e=Ds(c,h);e?as(e):f({playerData:null,profilePic:null,country:null,twitchName:null,isStreaming:!1,streamInfo:null,matches:[],totalMatches:0,sessionGames:[],seasonMmrs:[],ongoingGame:null,ladderStanding:null,allyStats:[],worstAllyStats:[],mapStats:[],worstMapStats:[],nemesisStats:[],currentPage:0,isLoading:!0}),is(),ps();const a=setInterval(ps,3e4);return()=>clearInterval(a)},[c,h]),A.useEffect(()=>{(async()=>{try{const[a,n,l]=await Promise.all([fetch(`${ws}/api/clips?player=${encodeURIComponent(c)}&limit=10`),fetch(`${ws}/api/admin/digests`),fetch(`${ws}/api/admin/stats/today`)]),m=((a.ok?await a.json():{clips:[]}).clips||[]).filter(x=>x.player_tag&&x.player_tag.toLowerCase().includes(c.toLowerCase())).slice(0,4),w=[],v=G.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),D=new RegExp(`\\b${v}\\b`,"i"),R=new Set(["MENTIONS","TOPICS"]),$=x=>{const i=Qs(x),I=[];for(const t of i)if(!R.has(t.key))for(const p of t.content.split(/;\s*/)){if(!p.trim()||!D.test(p))continue;const U=p.trim();I.push({key:t.key,snippet:U.length>120?U.slice(0,120)+"…":U})}return I};if(l.ok){const x=await l.json();if(x.digest){const i=$(x.digest);i.length>0&&w.push({date:x.date||new Date().toISOString().slice(0,10),sections:i})}}if(n.ok){const x=await n.json();for(const i of Array.isArray(x)?x:[]){if(!i.digest)continue;const I=$(i.digest);if(I.length>0&&w.push({date:i.date,sections:I}),w.length>=10)break}}f({playerClips:m,playerMentions:w})}catch(a){console.error("Failed to fetch player media:",a)}})()},[c]);const is=async()=>{f({isLoading:!0});try{const e=await Us(c),a=e==null?void 0:e.profilePicUrl,n=e==null?void 0:e.country,l=(e==null?void 0:e.twitch)||null,g={profilePic:a,country:n,twitchName:l};if(l){const I=await Hs(l);g.isStreaming=I.isLive,g.streamInfo=I.isLive?I:null}f(g);let m=null,w=0;const v=`https://website-backend.w3champions.com/api/players/${encodeURIComponent(c)}/game-mode-stats?gateway=${ls}&season=${h}`,D=await fetch(v);if(D.ok){const t=(await D.json()).find(p=>p.gameMode===4);t&&(m=t,w=(t.wins||0)+(t.losses||0),f({playerData:m,totalMatches:w}))}const R=await cs(0,!0),$=await hs(!0),x=await os(!0),i=await gs(!0);Is.set(`playerPage:${b}:${h}`,{playerData:m,profilePic:a,country:n,twitchName:l,matches:R||[],totalMatches:w,seasonMmrs:$||[],ladderStanding:x,allyStats:(i==null?void 0:i.allyStats)||[],worstAllyStats:(i==null?void 0:i.worstAllyStats)||[],mapStats:(i==null?void 0:i.mapStats)||[],worstMapStats:(i==null?void 0:i.worstMapStats)||[],nemesisStats:(i==null?void 0:i.nemesisStats)||[]},300*1e3)}catch(e){console.error("Error loading player data:",e)}finally{f({isLoading:!1})}},cs=async(e,a=!1)=>{const n=e*fs,l=`https://website-backend.w3champions.com/api/matches/search?playerId=${encodeURIComponent(c)}&offset=${n}&gameMode=4&season=${h}&gateway=${ls}&pageSize=${fs}`,g=await fetch(l);if(g.ok){const m=await g.json();if(m.matches&&(f({matches:m.matches}),e===0&&rs(m.matches),a))return m.matches}return a?[]:void 0},hs=async(e=!1)=>{const a=await _s(c,h);if(f({seasonMmrs:a}),e)return a},rs=e=>{var w;if(!e||e.length===0)return;const a=W*60*1e3,n=7200*1e3,l=[],g=new Date((w=e[0])==null?void 0:w.endTime);if(new Date-g>n)f({sessionGames:[]});else{for(let v=0;v<e.length;v++){const D=e[v];let R=null,$=!1;for(const x of D.teams){const i=x.players.find(I=>I.battleTag.toLowerCase()===b);if(i){R=i,$=i.won;break}}if(R){if(v>0&&new Date(e[v-1].endTime)-new Date(D.endTime)>a)break;l.push({...D,playerData:R,won:$})}}f({sessionGames:l})}},ps=async()=>{try{const a=await(await fetch("https://website-backend.w3champions.com/api/matches/ongoing")).json(),n=Ws(a,c);f({ongoingGame:n})}catch(e){console.error("Error fetching ongoing games:",e)}},os=async(e=!1)=>{try{const a=`https://website-backend.w3champions.com/api/ladder/search?gateWay=${ls}&searchFor=${encodeURIComponent(c.split("#")[0])}&gameMode=4&season=${h}`,n=await fetch(a);if(!n.ok)return e?null:void 0;const g=(await n.json()).find(p=>{var q,S,M,ms,Ms,ks,Rs;const U=(M=(S=(q=p.playersInfo)==null?void 0:q[0])==null?void 0:S.battleTag)==null?void 0:M.toLowerCase(),V=(Rs=(ks=(Ms=(ms=p.player)==null?void 0:ms.playerIds)==null?void 0:Ms[0])==null?void 0:ks.battleTag)==null?void 0:Rs.toLowerCase();return U===b||V===b});if(!g)return e?null:void 0;const m=g.league,w=Gs.find(p=>p.id===m),v=`https://website-backend.w3champions.com/api/ladder/${m}?gateWay=${ls}&gameMode=4&season=${h}`,D=await fetch(v);if(!D.ok)return e?null:void 0;const R=await D.json(),$=R.findIndex(p=>{var U,V,q;return((q=(V=(U=p.playersInfo)==null?void 0:U[0])==null?void 0:V.battleTag)==null?void 0:q.toLowerCase())===b});if($===-1)return e?null:void 0;const x=Math.max(0,$-2),i=Math.min(R.length,$+3),I=R.slice(x,i),t={league:w,leagueId:m,playerRank:g.rankNumber,playerIndex:$,neighbors:I,totalInLeague:R.length};if(f({ladderStanding:t}),e)return t}catch(a){return console.error("Error fetching ladder standing:",a),e?null:void 0}},gs=async(e=!1)=>{try{const a=`https://website-backend.w3champions.com/api/matches/search?playerId=${encodeURIComponent(c)}&offset=0&gameMode=4&season=${h}&gateway=${ls}&pageSize=100`,n=await fetch(a);if(!n.ok)return e?null:void 0;const l=await n.json();if(!l.matches||l.matches.length===0)return e?null:void 0;const g={},m={},w={};for(const t of l.matches){let p=null,U=null,V=!1;for(const S of t.teams){const M=S.players.find(ms=>ms.battleTag.toLowerCase()===b);M?(p=S,V=M.won):U=S}if(!p)continue;for(const S of p.players){if(S.battleTag.toLowerCase()===b)continue;const M=S.battleTag;g[M]||(g[M]={battleTag:M,name:S.name,wins:0,losses:0,total:0}),g[M].total+=1,V?g[M].wins+=1:g[M].losses+=1}if(U)for(const S of U.players){const M=S.battleTag;w[M]||(w[M]={battleTag:M,name:S.name,wins:0,losses:0,total:0}),w[M].total+=1,V?w[M].losses+=1:w[M].wins+=1}const q=t.mapName;if(q){const S=q.replace(/^\(\d\)\s*/,"");m[S]||(m[S]={name:S,wins:0,losses:0,total:0}),m[S].total+=1,V?m[S].wins+=1:m[S].losses+=1}}const v=Object.values(g).filter(t=>t.total>=xs).map(t=>({...t,winRate:Math.round(t.wins/t.total*100)})),D=[...v].sort((t,p)=>p.winRate-t.winRate||p.total-t.total).slice(0,3),R=[...v].filter(t=>t.losses>0).sort((t,p)=>t.winRate-p.winRate||p.total-t.total).slice(0,3),$=Object.values(m).filter(t=>t.total>=xs).map(t=>({...t,winRate:Math.round(t.wins/t.total*100)})),x=[...$].sort((t,p)=>p.winRate-t.winRate||p.total-t.total).slice(0,5),i=[...$].filter(t=>t.losses>0).sort((t,p)=>t.winRate-p.winRate||p.total-t.total).slice(0,3),I=Object.values(w).filter(t=>t.total>=xs&&t.wins>0).map(t=>({...t,winRate:Math.round(t.wins/t.total*100)})).sort((t,p)=>p.wins-t.wins||p.winRate-t.winRate).slice(0,3);if(f({allyStats:D,worstAllyStats:R,mapStats:x,worstMapStats:i,nemesisStats:I}),e)return{allyStats:D,worstAllyStats:R,mapStats:x,worstMapStats:i,nemesisStats:I}}catch(a){return console.error("Error fetching statistics:",a),e?null:void 0}},ds=e=>{f({selectedSeason:parseInt(e.target.value,10)})},ts=async e=>{var a;f({currentPage:e}),await cs(e),window.scrollTo({top:((a=document.querySelector(".match-history-section"))==null?void 0:a.offsetTop)-100||0,behavior:"smooth"})};if(ss)return s.jsx("div",{className:"player-page",children:s.jsx("div",{className:"player-loading",children:s.jsx(Os,{})})});const Ns=C.filter(e=>e.won).length,Ts=C.length-Ns,us=C.length>0?(((ys=C[0].playerData)==null?void 0:ys.currentMmr)||0)-(((vs=C[C.length-1].playerData)==null?void 0:vs.oldMmr)||0):0,Ls=k&&k.wins+k.losses>0?Math.round(k.wins/(k.wins+k.losses)*100):0,ns=Math.ceil(B/fs),Ps=/[WL]{4,}/g,As=e=>{const a=[];let n=0;for(const l of e.matchAll(Ps)){l.index>n&&a.push(e.slice(n,l.index));const g=[...l[0]].map(m=>m==="W");a.push(s.jsx(Cs,{form:g,size:"small"},l.index)),n=l.index+l[0].length}return n<e.length&&a.push(e.slice(n)),a.length>1?a:e};return s.jsxs("div",{className:"player-page",children:[s.jsxs("header",{className:"player-header",children:[s.jsxs("div",{className:"player-header-left",children:[s.jsxs("div",{className:"hd-pic-wrapper",children:[E&&s.jsx("img",{src:E,alt:"",className:"hd-pic"}),z&&s.jsx(Fs,{name:z.toLowerCase(),className:"hd-flag"})]}),s.jsxs("div",{className:"hd-info",children:[s.jsxs("div",{className:"hd-name-row",children:[s.jsx("span",{className:"hd-name",children:G}),Z&&s.jsx(Vs,{className:"in-game-icon",title:"In Game"}),Q&&L&&s.jsx("a",{href:`https://twitch.tv/${L}`,target:"_blank",rel:"noopener noreferrer",className:"twitch-link",title:(H==null?void 0:H.title)||"Live on Twitch",children:s.jsx(Bs,{className:"twitch-icon",style:{fill:"#9146ff"}})})]}),k&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"hd-stats-row",children:[F&&s.jsxs("span",{className:"hd-rank",children:["#",F.playerRank]}),s.jsx("span",{className:"hd-mmr",children:k.mmr}),s.jsx("span",{className:"hd-mmr-label",children:"MMR"})]}),s.jsxs("div",{className:"hd-record-row",children:[s.jsxs("span",{className:"hd-wins",children:[k.wins,"W"]}),s.jsxs("span",{className:"hd-losses",children:["-",k.losses,"L"]}),s.jsx("span",{className:"hd-sep",children:"·"}),s.jsxs("span",{className:"hd-winrate",children:[Ls,"%"]})]})]})]})]}),s.jsx("div",{className:"player-header-right",children:s.jsx("div",{className:"season-selector",children:s.jsx(Ks,{value:h||"",onChange:ds,children:P.map(e=>s.jsxs("option",{value:e.id,children:["S",e.id]},e.id))})})})]}),(u.length>0||N.length>0)&&s.jsxs("div",{className:"player-highlights",children:[N.length>0&&s.jsxs("div",{className:"ph-group ph-group--news",children:[s.jsxs("div",{className:"section-header",children:[s.jsx("h2",{className:"section-title",children:"In the News"}),s.jsx(J,{to:`/news?player=${encodeURIComponent(c)}`,children:s.jsx($s,{$secondary:!0,children:"More"})})]}),s.jsx("div",{className:"ph-news-list",children:N.flatMap(e=>e.sections.map((a,n)=>({key:`${e.date}-${n}`,date:e.date,sec:a}))).slice(0,4).map(({key:e,date:a,sec:n})=>{const l=new Date(a+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"});return s.jsxs(J,{to:`/news?date=${a}`,className:"ph-news-item",children:[s.jsx("span",{className:`ph-badge ph-badge--${n.key.toLowerCase()}`,children:n.key}),s.jsx("span",{className:"ph-news-snippet",children:As(n.snippet)}),s.jsx("span",{className:"ph-news-date",children:l})]},e)})})]}),u.length>0&&s.jsxs("div",{className:"ph-group ph-group--clips",children:[s.jsxs("div",{className:"section-header",children:[s.jsx("h2",{className:"section-title",children:"Clips"}),s.jsx(J,{to:`/clips?player=${encodeURIComponent(c)}`,children:s.jsx($s,{$secondary:!0,children:"More"})})]}),s.jsx("div",{className:"ph-clips",children:u.slice(0,4).map(e=>s.jsxs("button",{className:"ph-clip",onClick:()=>K(e),title:e.title,children:[s.jsx("img",{src:e.thumbnail_url,alt:"",loading:"lazy"}),s.jsx("div",{className:"ph-clip-overlay",children:s.jsx("div",{className:"ph-clip-play",children:"▶"})}),s.jsx("span",{className:"ph-clip-title",children:e.title})]},e.clip_id))})]})]}),s.jsxs("div",{className:"player-content",children:[s.jsxs("main",{className:"player-main",children:[Z&&s.jsxs("section",{className:"live-game-section",children:[s.jsx("div",{className:"section-header",children:s.jsx("h2",{className:"section-title",children:"Live Game"})}),s.jsx(Js,{ongoingGameData:Z,compact:!0,streamerTag:c})]}),s.jsxs("section",{className:"match-history-section",children:[s.jsxs("div",{className:"section-header",children:[s.jsx("h2",{className:"section-title",children:"Match History"}),s.jsxs("span",{className:"match-count",children:[B," games"]})]}),s.jsxs("div",{className:"match-history-table",children:[s.jsxs("div",{className:"mh-header",children:[s.jsx("div",{className:"mh-col result",children:"Result"}),s.jsx("div",{className:"mh-col map",children:"Map"}),s.jsx("div",{className:"mh-col avg-mmr",children:"Avg MMR"}),s.jsx("div",{className:"mh-col mmr",children:"+/-"}),s.jsx("div",{className:"mh-col allies",children:"Allies"}),s.jsx("div",{className:"mh-col opponents",children:"Opponents"}),s.jsx("div",{className:"mh-col duration",children:"Duration"}),s.jsx("div",{className:"mh-col time",children:"Time"})]}),Y.map((e,a)=>s.jsx(Zs,{game:e,playerBattleTag:c,striped:a%2===1},e.id))]}),ns>1&&s.jsxs("div",{className:"pagination",children:[s.jsx("button",{className:"page-btn",disabled:r===0,onClick:()=>ts(r-1),children:"Prev"}),s.jsx("div",{className:"page-numbers",children:[...Array(Math.min(5,ns))].map((e,a)=>{let n;return ns<=5||r<3?n=a:r>ns-4?n=ns-5+a:n=r-2+a,s.jsx("button",{className:`page-num ${r===n?"active":""}`,onClick:()=>ts(n),children:n+1},n)})}),s.jsx("button",{className:"page-btn",disabled:r>=ns-1,onClick:()=>ts(r+1),children:"Next"})]})]})]}),s.jsxs("aside",{className:"player-sidebar",children:[F&&s.jsxs("div",{className:"ladder-standing",children:[s.jsxs("div",{className:"ls-header",children:[s.jsx("img",{src:(Ss=F.league)==null?void 0:Ss.icon,alt:"",className:"ls-league-icon"}),s.jsx("span",{className:"ls-league-name",children:(bs=F.league)==null?void 0:bs.name})]}),s.jsx("div",{className:"ls-list",children:F.neighbors.map(e=>{var l,g,m,w,v,D,R,$,x;const a=((m=(g=(l=e.playersInfo)==null?void 0:l[0])==null?void 0:g.battleTag)==null?void 0:m.toLowerCase())===b,n=(v=(w=e.playersInfo)==null?void 0:w[0])==null?void 0:v.battleTag;return s.jsxs(J,{to:a?"#":`/player/${encodeURIComponent(n)}`,className:`ls-row ${a?"me":""}`,onClick:i=>a&&i.preventDefault(),children:[s.jsxs("span",{className:"ls-rank",children:["#",e.rankNumber]}),s.jsx("img",{src:js[(R=(D=e.playersInfo)==null?void 0:D[0])==null?void 0:R.calculatedRace],alt:"",className:"ls-race"}),s.jsx("span",{className:"ls-name",children:($=e.player)==null?void 0:$.name}),s.jsx("span",{className:"ls-mmr",children:(x=e.player)==null?void 0:x.mmr})]},e.id)})})]}),C.length>0&&(()=>{const e=C[C.length-1],a=C[0],n=e!=null&&e.startTime?new Date(e.startTime):null,l=a!=null&&a.endTime?new Date(a.endTime):null;let g=null;if(n&&l){const m=l-n,w=Math.floor(m/(1e3*60*60)),v=Math.floor(m%(1e3*60*60)/(1e3*60));g=w>0?`${w}h ${v}m`:`${v}m`}return s.jsxs("div",{className:"session-card",children:[s.jsx("h3",{className:"sc-title",children:"Session Summary"}),s.jsxs("div",{className:"sc-stats",children:[s.jsxs("div",{className:"sc-stat",children:[s.jsx("span",{className:"sc-label",children:"Duration"}),s.jsx("span",{className:"sc-value",children:g||`${C.length} games`})]}),s.jsxs("div",{className:"sc-stat",children:[s.jsx("span",{className:"sc-label",children:"Record"}),s.jsxs("span",{className:"sc-value",children:[Ns,"W-",Ts,"L"]})]}),s.jsxs("div",{className:"sc-stat",children:[s.jsx("span",{className:"sc-label",children:"MMR"}),s.jsxs("span",{className:`sc-value ${us>=0?"positive":"negative"}`,children:[us>=0?"+":"",us]})]})]}),s.jsx("div",{className:"sc-form",children:s.jsx(Cs,{form:C.slice().reverse().map(m=>m.won),size:"medium"})})]})})(),O.length>2&&(()=>{const e=Math.min(...O),a=Math.max(...O),n=O[O.length-1],l=a-e,g=l>0?(n-e)/l*100:50;return s.jsxs("div",{className:"mmr-thermometer-card",children:[s.jsxs("h3",{className:"mtc-title",children:["Season ",h," MMR"]}),s.jsxs("div",{className:"mtc-bar",children:[s.jsx("div",{className:"mtc-bar-track",children:s.jsx("div",{className:"mtc-bar-marker",style:{left:`${g}%`}})}),s.jsxs("div",{className:"mtc-bar-labels",children:[s.jsxs("div",{className:"mtc-label-group",children:[s.jsx("span",{className:"mtc-value low",children:e}),s.jsx("span",{className:"mtc-label",children:"LOW"})]}),s.jsxs("div",{className:"mtc-label-group current",children:[s.jsx("span",{className:"mtc-value",children:n}),s.jsx("span",{className:"mtc-label",children:"CURRENT"})]}),s.jsxs("div",{className:"mtc-label-group",children:[s.jsx("span",{className:"mtc-value high",children:a}),s.jsx("span",{className:"mtc-label",children:"PEAK"})]})]})]})]})})(),s.jsx(te,{battleTag:c,currentSeason:h,gateway:ls}),X.length>0&&s.jsxs("div",{className:"best-allies-card",children:[s.jsx("h3",{className:"bac-title",children:"Best Allies"}),s.jsx("div",{className:"bac-list",children:X.map((e,a)=>s.jsxs(J,{to:`/player/${encodeURIComponent(e.battleTag)}`,className:"bac-row",children:[s.jsxs("span",{className:"bac-rank",children:["#",a+1]}),s.jsx("span",{className:"bac-name",children:e.name}),s.jsxs("span",{className:"bac-stats",children:[s.jsxs("span",{className:"bac-winrate",children:[e.winRate,"%"]}),s.jsxs("span",{className:"bac-record",children:["(",e.wins,"W-",e.losses,"L)"]})]})]},e.battleTag))})]}),o.length>0&&s.jsxs("div",{className:"best-maps-card",children:[s.jsx("h3",{className:"bmc-title",children:"Best Maps"}),s.jsx("div",{className:"bmc-list",children:o.map((e,a)=>s.jsxs("div",{className:"bmc-row",children:[s.jsxs("span",{className:"bmc-rank",children:["#",a+1]}),s.jsx("span",{className:"bmc-name",children:e.name}),s.jsxs("span",{className:"bmc-stats",children:[s.jsxs("span",{className:"bmc-winrate",children:[e.winRate,"%"]}),s.jsxs("span",{className:"bmc-record",children:["(",e.wins,"W-",e.losses,"L)"]})]})]},e.name))})]}),es.length>0&&s.jsxs("div",{className:"worst-allies-card",children:[s.jsx("h3",{className:"wac-title",children:"Worst Allies"}),s.jsx("div",{className:"wac-list",children:es.map((e,a)=>s.jsxs(J,{to:`/player/${encodeURIComponent(e.battleTag)}`,className:"wac-row",children:[s.jsxs("span",{className:"wac-rank",children:["#",a+1]}),s.jsx("span",{className:"wac-name",children:e.name}),s.jsxs("span",{className:"wac-stats",children:[s.jsxs("span",{className:"wac-winrate",children:[e.winRate,"%"]}),s.jsxs("span",{className:"wac-record",children:["(",e.wins,"W-",e.losses,"L)"]})]})]},e.battleTag))})]}),d.length>0&&s.jsxs("div",{className:"worst-maps-card",children:[s.jsx("h3",{className:"wmc-title",children:"Worst Maps"}),s.jsx("div",{className:"wmc-list",children:d.map((e,a)=>s.jsxs("div",{className:"wmc-row",children:[s.jsxs("span",{className:"wmc-rank",children:["#",a+1]}),s.jsx("span",{className:"wmc-name",children:e.name}),s.jsxs("span",{className:"wmc-stats",children:[s.jsxs("span",{className:"wmc-winrate",children:[e.winRate,"%"]}),s.jsxs("span",{className:"wmc-record",children:["(",e.wins,"W-",e.losses,"L)"]})]})]},e.name))})]}),j.length>0&&s.jsxs("div",{className:"nemesis-card",children:[s.jsx("h3",{className:"nc-title",children:"Nemesis"}),s.jsx("div",{className:"nc-list",children:j.map((e,a)=>{const n=e.total>0?Math.round(e.losses/e.total*100):0;return s.jsxs(J,{to:`/player/${encodeURIComponent(e.battleTag)}`,className:"nc-row",children:[s.jsxs("span",{className:"nc-rank",children:["#",a+1]}),s.jsx("span",{className:"nc-name",children:e.name}),s.jsxs("span",{className:"nc-stats",children:[s.jsxs("span",{className:"nc-winrate",children:[n,"%"]}),s.jsxs("span",{className:"nc-record",children:["(",e.losses,"W-",e.wins,"L)"]})]})]},e.battleTag)})})]})]})]}),T&&s.jsx(ne,{clip:T,onClose:()=>K(null)})]})};export{xe as default};
